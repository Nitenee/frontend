(function(){"use strict";var e={6025:function(e,t,n){var a=n(5130),o=n(3367),i=n(6768),r=(n(4114),n(3375),n(9225),n(3972),n(9209),n(5714),n(7561),n(6197),n(4232)),l=n(144);const s=(0,o.nY)("kanji-settings",(()=>{const e=(0,l.KR)(3),t=(0,l.KR)(!0),n=(0,l.KR)(!0),a=(0,l.KR)(!0),o=(0,l.KR)(!1),i=(0,l.KR)(""),r=(0,l.KR)(60),s=(0,l.KR)(1);function c(t){e.value=t}function u(e){t.value=e}function p(e){n.value=e}function d(e){a.value=e}function v(e){o.value=e}function g(e){i.value=e}function h(e){r.value=e}function m(e){s.value=e}return{batchSize:e,groupKanji:t,autoCheck:n,autoContinue:a,useWanikaniLevel:o,wanikaniAPIKey:i,levelLimitUpper:r,levelLimitLower:s,setBatchSize:c,setGroupKanji:u,setAutoCheck:p,setAutoContinue:d,setUseWanikaniLevel:v,setWanikaniAPIKey:g,setLevelLimitUpper:h,setLevelLimitLower:m}})),c=(0,o.nY)("drag-and-drop",(()=>{const e=(0,l.KR)(!1),t=(0,l.KR)(null),n=(0,l.KR)(null),a=(0,l.KR)(void 0),o=(0,l.Kh)({x:0,y:0});function i(o){o.element.style.opacity="0.3",e.value=!0,t.value=o.element,n.value=o.meaning,a.value=o.draggingAttachedCharacter}function r(){t.value&&(t.value.style.opacity="1"),e.value=!1,t.value=null,n.value=null,a.value=void 0}function s(e){o.x=e.x,o.y=e.y}function c(){e.value?document.body.style.cursor="grabbing":document.body.style.cursor="default"}return{isDragging:e,draggingElement:t,draggingMeaning:n,draggingAttachedCharacter:a,setDragging:i,clearDragging:r,pointerPosition:o,setPointerPosition:s,checkCursor:c}})),u=(0,o.nY)("kanji-state",(()=>{const e=(0,l.Kh)({meanings:[],characters:[]}),t=(0,l.KR)(!1),n=(0,l.KR)(!1),a=(0,l.KR)(null),o=(0,l.KR)(null);function i(e){n.value=e}function r(t,n,a){a?(setTimeout((()=>e.characters=n),1e3),setTimeout((()=>e.meanings=t),1500)):(e.meanings=t,e.characters=n)}function s(t){e.meanings=t}function c(t){e.characters=t}function u(e){t.value=e}function p(){e.meanings=[],e.characters=[]}function d(t){const{goingToCharacter:n,comingFromCharacter:o,oldMeaning:i,newMeaning:r}=t;if("MEANINGZONE"===n){if(e.meanings.find((e=>e==r)))return;const t=e.characters.find((e=>e.kanji==o));return t?(t.attachedMeaning="",void e.meanings.push(r)):void console.error(`Meaning coming from ${o} but unable to find it in list.`)}if(o&&i){const t=e.characters.find((e=>e.kanji==o));if(!t)return void console.error(`Meaning coming from ${o} but unable to find it in list.`);t.attachedMeaning=i}else if(!o&&i)e.meanings.push(i);else if(o&&!i){const t=e.characters.find((e=>e.kanji==o));if(!t)return void console.error(`Meaning coming from ${o} but unable to find it in list.`);t.attachedMeaning=""}e.meanings=e.meanings.filter((e=>e!=r));const l=e.characters.find((e=>e.kanji==n));if(!l)throw new Error(`Unable to find ${n} in modelData.characters while trying to set attachedMeaning to newMeaning`);if(l.attachedMeaning=r,!a.value)throw new Error("checkAnswers function is null in kanji-state store");a.value()}function v(e){a.value=e}function g(e){o.value=e}return{modelData:e,readyToGoToNextKanjiBatch:n,hasSelectedSettings:t,setModelData:r,setModelDataMeanings:s,setModelDataCharacters:c,setHasSelectedSettings:u,clearModelData:p,setReadyToGoToNextKanjiBatch:i,setCheckAnswers:v,setAllCorrectWaveAnimation:g,processDrop:d}}));var p=n(1114);class d{constructor(e){(0,p.A)(this,"head",null),(0,p.A)(this,"tail",null),(0,p.A)(this,"length",0),(0,p.A)(this,"maxLength",void 0),this.maxLength=e}push(e){const t={compliment:e,next:this.tail||null,prev:null};if(this.head||(this.head=t),this.tail&&(this.tail.prev=t),this.tail=t,this.length<this.maxLength)return this.length++,null;{const e=this.head;return this.head=this.head.prev,this.head.next=null,e.compliment}}}const v=5,g=new d(v),h=["ナイス！","グッドジョブ！","いいね！","レッツゴー！","ファイティング！","オッケーオッケー！","よっしゃー！"];if(v>=h.length)throw new Error("complimentQueueMaxLength cannot be greater than or equal to complimentPool's length");function m(){const e=Math.floor(Math.random()*h.length),t=h.splice(e,1)[0];console.log("randomIndex:",e,"complimentPool",h,"randomCompliment",t);const n=g.push(t);return n&&h.push(n),console.log("Current head: ",g.head),t}async function f(e){const t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)},n=await fetch("/api",t),a=await n.json();return a}function k(e){let t=e.length;while(0!=t){const n=Math.floor(Math.random()*t);t--,[e[t],e[n]]=[e[n],e[t]]}return e}async function L(e){const t=await fetch("https://api.wanikani.com/v2/user",{headers:{"Wanikani-Revision":"20170710",Authorization:`Bearer ${e}`}}),n=await t.json();return n}function y(e){const{y2:t,y1:n,x2:a,x1:o}=e;return(t-n)/(a-o)}function w(e,t,n){const a=t-n*e;return{slope:n,intercept:a}}function b(e,t){const n=y(e),a=y(t),o=w(e.x1,e.y1,n),i=w(t.x1,t.y1,a),r=(i.intercept-o.intercept)/(o.slope-i.slope),l=i.slope*r+i.intercept;return{x:r,y:l}}function C(e,t,n,a){const o=n-e,i=a-t;return Math.atan2(i,o)}function x(e,t){const n=Math.sqrt(e*e+t*t);return 0===n?{x:0,y:0}:{x:e/n,y:t/n}}var S=n(4968);const E={height:"35px",id:"Layer_1",style:{"enable-background":"new 0 0 512 512"},version:"1.1",viewBox:"0 0 512 512",width:"35px","xml:space":"preserve",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},_=(0,i.Lk)("path",{d:"M424.5,216.5h-15.2c-12.4,0-22.8-10.7-22.8-23.4c0-6.4,2.7-12.2,7.5-16.5l9.8-9.6c9.7-9.6,9.7-25.3,0-34.9l-22.3-22.1  c-4.4-4.4-10.9-7-17.5-7c-6.6,0-13,2.6-17.5,7l-9.4,9.4c-4.5,5-10.5,7.7-17,7.7c-12.8,0-23.5-10.4-23.5-22.7V89.1  c0-13.5-10.9-25.1-24.5-25.1h-30.4c-13.6,0-24.4,11.5-24.4,25.1v15.2c0,12.3-10.7,22.7-23.5,22.7c-6.4,0-12.3-2.7-16.6-7.4l-9.7-9.6  c-4.4-4.5-10.9-7-17.5-7s-13,2.6-17.5,7L110,132c-9.6,9.6-9.6,25.3,0,34.8l9.4,9.4c5,4.5,7.8,10.5,7.8,16.9  c0,12.8-10.4,23.4-22.8,23.4H89.2c-13.7,0-25.2,10.7-25.2,24.3V256v15.2c0,13.5,11.5,24.3,25.2,24.3h15.2  c12.4,0,22.8,10.7,22.8,23.4c0,6.4-2.8,12.4-7.8,16.9l-9.4,9.3c-9.6,9.6-9.6,25.3,0,34.8l22.3,22.2c4.4,4.5,10.9,7,17.5,7  c6.6,0,13-2.6,17.5-7l9.7-9.6c4.2-4.7,10.2-7.4,16.6-7.4c12.8,0,23.5,10.4,23.5,22.7v15.2c0,13.5,10.8,25.1,24.5,25.1h30.4  c13.6,0,24.4-11.5,24.4-25.1v-15.2c0-12.3,10.7-22.7,23.5-22.7c6.4,0,12.4,2.8,17,7.7l9.4,9.4c4.5,4.4,10.9,7,17.5,7  c6.6,0,13-2.6,17.5-7l22.3-22.2c9.6-9.6,9.6-25.3,0-34.9l-9.8-9.6c-4.8-4.3-7.5-10.2-7.5-16.5c0-12.8,10.4-23.4,22.8-23.4h15.2  c13.6,0,23.3-10.7,23.3-24.3V256v-15.2C447.8,227.2,438.1,216.5,424.5,216.5z M336.8,256L336.8,256c0,44.1-35.7,80-80,80  c-44.3,0-80-35.9-80-80l0,0l0,0c0-44.1,35.7-80,80-80C301.1,176,336.8,211.9,336.8,256L336.8,256z"},null,-1),j=[_];function R(e,t){return(0,i.uX)(),(0,i.CE)("svg",E,j)}var M=n(1241);const K={},A=(0,M.A)(K,[["render",R]]);var T=A;const z=e=>((0,i.Qi)("data-v-2c62272b"),e=e(),(0,i.jt)(),e),I=z((()=>(0,i.Lk)("div",{class:"app-name"},[(0,i.Lk)("div",null,"似"),(0,i.Lk)("div",null,"て"),(0,i.Lk)("div",null,"ね"),(0,i.Lk)("div",null,"ー"),(0,i.Lk)("div",null,"！")],-1))),X={class:"settings-button-container"};var B=(0,i.pM)({__name:"NavBar",emits:["togglesettings"],setup(e,{emit:t}){const n=t;return(e,t)=>((0,i.uX)(),(0,i.CE)("nav",null,[I,(0,i.Lk)("div",X,[(0,i.Lk)("button",{class:"settings-button",onClick:t[0]||(t[0]=(0,a.D$)((e=>n("togglesettings")),["prevent"]))},[(0,i.bF)(T)])])]))}});const P=(0,M.A)(B,[["__scopeId","data-v-2c62272b"]]);var D=P;const W={class:"popover-text"},U={class:"popover-subtext"};var F=(0,i.pM)({__name:"PopOver",props:{popoverText:{},popoverSubtext:{}},setup(e,{expose:t}){const n=(0,l.KR)(null);return t({popover:n}),(e,t)=>((0,i.uX)(),(0,i.CE)("div",{class:"popover",ref_key:"popover",ref:n},[(0,i.Lk)("div",null,[(0,i.Lk)("div",W,(0,r.v_)(e.popoverText),1),(0,i.Lk)("div",U,(0,r.v_)(e.popoverSubtext),1)])],512))}});const N=(0,M.A)(F,[["__scopeId","data-v-6dadaf50"]]);var O=N;const V=e=>((0,i.Qi)("data-v-77583eda"),e=e(),(0,i.jt)(),e),H={class:"puzzle-knob-container"},G={class:"puzzle-knob",height:"35",width:"100"},Q=V((()=>(0,i.Lk)("path",{class:"puzzle-knob-stroker",d:"m 16 29 C 24 29 27 29 27 19 V 16 C 27 5 32 2 43 2 H 57 C 68 2 73 5 73 16 V 19 C 73 29 76 29 84 29 L 100 29 L 100 34 L 0 34 L 0 29 z"},null,-1))),$={key:0,class:"puzzle-knob-inner",d:"m 19 31 C 24 31 32 27 32 19 V 10 C 32 7 35 3 38 3 H 62 C 65 3 68 7 68 10 V 19 C 68 27 76 31 81 31 L 100 31 L 100 32 L 0 32 L 0 31 z"},Y={key:1,class:"puzzle-knob-inner",d:"m 19 31 C 24 31 32 27 32 19 V 10 C 32 7 35 3 38 3 H 62 C 65 3 68 7 68 10 V 19 C 68 27 76 31 81 31 L 95 31 L 95 32 L 5 32 L 5 31 z"},q={class:"meaning",lang:"en"};var J=(0,i.pM)({__name:"KanjiMeaning",props:{meaning:String,attachedCharacter:String},setup(e){const t=(0,l.KR)(null),n=c(),o=e,s=((0,i.EW)((()=>{const e=["puzzle-hole"];return o.attachedCharacter&&e.push("no-shadow"),e.join(" ")})),(0,i.EW)((()=>o.attachedCharacter?"attached":"")));function u(e){if(!t.value)throw new Error("Clicked on meaning but ref is null");if(!o.meaning)throw new Error("Clicked on meaning but meaning prop is null");"mouse"===e.pointerType&&0!==e.button||n.setDragging({element:t.value,meaning:o.meaning,draggingAttachedCharacter:o.attachedCharacter})}return(n,o)=>((0,i.uX)(),(0,i.CE)("div",{class:(0,r.C4)(["container",s.value]),ref_key:"containerElement",ref:t,onPointerdown:(0,a.D$)(u,["prevent","stop"])},[(0,i.Lk)("div",null,[(0,i.Lk)("div",H,[((0,i.uX)(),(0,i.CE)("svg",G,[Q,e.attachedCharacter?((0,i.uX)(),(0,i.CE)("path",$)):((0,i.uX)(),(0,i.CE)("path",Y))]))]),(0,i.Lk)("div",q,[(0,i.Lk)("span",null,(0,r.v_)(e.meaning),1)])])],34))}});const Z=(0,M.A)(J,[["__scopeId","data-v-77583eda"]]);var ee=Z,te=(0,i.pM)({__name:"DragIllusion",setup(e){const{isDragging:t,draggingMeaning:n,pointerPosition:a}=(0,o.bP)(c()),s=(0,i.EW)((()=>{if(!t.value)return"display: none;";const{x:e,y:n}=a.value;return`left: ${e-50}px; top: ${n-15}px;`}));return(e,t)=>((0,i.uX)(),(0,i.CE)("div",{style:(0,r.Tr)(s.value)},[(0,i.bF)(ee,{meaning:(0,l.R1)(n),"attached-character":""},null,8,["meaning"])],4))}});const ne=(0,M.A)(te,[["__scopeId","data-v-284e0313"]]);var ae=ne;const oe=e=>((0,i.Qi)("data-v-f5815342"),e=e(),(0,i.jt)(),e),ie={key:0,class:"top-left",height:"20",width:"20"},re=oe((()=>(0,i.Lk)("path",{d:"m20,0 h-20 v20 a20,20 0 0 1 20,-20 z"},null,-1))),le=[re],se={key:1,class:"top-right",height:"20",width:"20"},ce=oe((()=>(0,i.Lk)("path",{d:"m20,20 v-20 h-20 a20,20 0 0 1 20,20 z"},null,-1))),ue=[ce],pe={key:2,class:"bottom-right",height:"20",width:"20"},de=oe((()=>(0,i.Lk)("path",{d:"m0,20 h20 v-20 a20,20 0 0 1 -20,20 z"},null,-1))),ve=[de],ge={key:3,class:"bottom-left",height:"20",width:"20"},he=oe((()=>(0,i.Lk)("path",{d:"m0,0 v20 h20 a20,20 0 0 1 -20,-20z"},null,-1))),me=[he];var fe=(0,i.pM)({__name:"RoundedCorners",props:{hideTopLeft:{type:Boolean,default:!1},hideTopRight:{type:Boolean,default:!1},hideBottomRight:{type:Boolean,default:!1},hideBottomLeft:{type:Boolean,default:!1}},setup(e){return(t,n)=>((0,i.uX)(),(0,i.CE)(i.FK,null,[e.hideTopLeft?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("svg",ie,le)),e.hideTopRight?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("svg",se,ue)),e.hideBottomRight?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("svg",pe,ve)),e.hideBottomLeft?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("svg",ge,me))],64))}});const ke=(0,M.A)(fe,[["__scopeId","data-v-f5815342"]]);var Le=ke;const ye={class:"kanji-meanings"},we={class:"curve"},be={class:"button-container"},Ce=["disabled"],xe={key:0},Se={key:1},Ee={key:2},_e={class:"kanji-meaning-items-container"};var je=(0,i.pM)({__name:"KanjiMeaningsSection",emits:["onSubmit"],setup(e,{emit:t}){const n=u(),o=(0,i.EW)((()=>n.readyToGoToNextKanjiBatch?"continue":""));function s(e,t){S.Ay.fromTo(e,{opacity:0,transform:"translateX(-50px) scale(0.5)"},{opacity:1,transform:"translateX(0) scale(1)",ease:"elastic.out",delay:.1*Number(e.dataset.index),onComplete:()=>{e.setAttribute("style",""),t()}})}const c=t;return(e,t)=>((0,i.uX)(),(0,i.CE)("section",ye,[(0,i.Lk)("div",we,[(0,i.Lk)("div",be,[(0,i.Lk)("div",null,[(0,i.Lk)("button",{class:(0,r.C4)(["submit-button",o.value]),disabled:!(0,l.R1)(n).hasSelectedSettings,onClick:t[0]||(t[0]=(0,a.D$)((e=>c("onSubmit")),["prevent"]))},[(0,i.bF)(a.eB,{name:"check-button",mode:"out-in"},{default:(0,i.k6)((()=>[(0,l.R1)(n).hasSelectedSettings?(0,l.R1)(n).readyToGoToNextKanjiBatch?((0,i.uX)(),(0,i.CE)("span",Se,"Continue")):((0,i.uX)(),(0,i.CE)("span",Ee,"Check")):((0,i.uX)(),(0,i.CE)("span",xe,"Disabled"))])),_:1})],10,Ce)])])]),(0,i.Lk)("div",_e,[(0,i.Lk)("div",null,[(0,i.bF)(Le,{hideBottomRight:!0,hideTopRight:!0}),(0,i.bF)(a.F,{tag:"div",class:"meanings",name:"meaning",onEnter:s},{default:(0,i.k6)((()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)((0,l.R1)(n).modelData.meanings,((e,t)=>((0,i.uX)(),(0,i.Wv)(ee,{key:e,"data-index":t,meaning:e,attachedCharacter:""},null,8,["data-index","meaning"])))),128))])),_:1})])])]))}});const Re=(0,M.A)(je,[["__scopeId","data-v-36d3188e"]]);var Me=Re;const Ke=e=>((0,i.Qi)("data-v-31c337c0"),e=e(),(0,i.jt)(),e),Ae={class:"puzzle-hole-container"},Te=Ke((()=>(0,i.Lk)("path",{d:"m 20 32 C 25 32 30 27 30 22 V 14 C 30 7 35 4 40 4 H 60 C 65 4 70 9 70 14 V 22 C 70 27 75 32 80 32 L 100 32 L 100 0 L 0 0 L 0 32 z"},null,-1))),ze=[Te];var Ie=(0,i.pM)({__name:"KanjiCharacter",props:{character:{},incorrect:{type:[Boolean,null]}},setup(e){const t=e,n=(0,i.EW)((()=>t.incorrect?"incorrect":""));return(e,t)=>((0,i.uX)(),(0,i.CE)("div",null,[(0,i.Lk)("div",{class:(0,r.C4)(["character",n.value])},[(0,i.Lk)("span",null,(0,r.v_)(e.character),1)],2),(0,i.Lk)("div",Ae,[((0,i.uX)(),(0,i.CE)("svg",{class:(0,r.C4)(["puzzle-hole",n.value]),height:"32",width:"100"},ze,2))])]))}});const Xe=(0,M.A)(Ie,[["__scopeId","data-v-31c337c0"]]);var Be=Xe;const Pe=e=>((0,i.Qi)("data-v-40c03cba"),e=e(),(0,i.jt)(),e),De=Pe((()=>(0,i.Lk)("div",{class:"shine"},null,-1)));var We=(0,i.pM)({__name:"KanjiContainer",props:{kanji:{},attachedMeaning:{},incorrect:{type:[Boolean,null]}},emits:["dropmeaning"],setup(e,{emit:t}){const n=e,o=c(),l=u();function s(e){if(o.isDragging){if(void 0==o.draggingAttachedCharacter||null==o.draggingMeaning)throw new Error("Trying to drop an undefined or null");l.processDrop({goingToCharacter:n.kanji,comingFromCharacter:o.draggingAttachedCharacter,oldMeaning:n.attachedMeaning,newMeaning:o.draggingMeaning}),o.clearDragging()}}return(e,t)=>((0,i.uX)(),(0,i.CE)("div",{class:(0,r.C4)(["kanji",e.attachedMeaning?"attached":""]),onPointerup:(0,a.D$)(s,["prevent","stop"])},[(0,i.Lk)("div",null,[De,(0,i.bF)(Be,{character:e.kanji,incorrect:e.incorrect},null,8,["character","incorrect"]),(0,i.Lk)("div",{class:(0,r.C4)(["meaning-drop-zone",e.attachedMeaning?"attached":""])},[e.attachedMeaning?((0,i.uX)(),(0,i.Wv)(ee,{key:0,meaning:e.attachedMeaning,attachedCharacter:e.kanji},null,8,["meaning","attachedCharacter"])):(0,i.Q3)("",!0)],2)])],34))}});const Ue=(0,M.A)(We,[["__scopeId","data-v-40c03cba"]]);var Fe=Ue;const Ne=e=>((0,i.Qi)("data-v-c3c4e312"),e=e(),(0,i.jt)(),e),Oe={class:"kanji-characters-container"},Ve=Ne((()=>(0,i.Lk)("div",{class:"background-layer"},null,-1))),He=Ne((()=>(0,i.Lk)("div",{class:"background-layer-shadow"},null,-1)));var Ge=(0,i.pM)({__name:"KanjiCharacterSection",setup(e){const{modelData:t}=u();function n(e,t){S.Ay.fromTo(e,{opacity:0,transform:"translateY(-50px)"},{opacity:1,transform:"translateY(0px)",ease:"power4.out",delay:.1*Number(e.dataset.index),onComplete:t})}function o(e,t){S.Ay.to(e,{opacity:0,transform:"translateY(100px)",ease:"power4.in",onComplete:t})}return(e,r)=>((0,i.uX)(),(0,i.CE)("section",Oe,[Ve,He,(0,i.bF)(Le,{hideBottomLeft:!0,hideTopRight:!0,hideBottomRight:!0}),(0,i.bF)(a.F,{tag:"div",class:"kanji-characters",name:"meaning",onEnter:n,onLeave:o},{default:(0,i.k6)((()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)((0,l.R1)(t).characters,((e,t)=>((0,i.uX)(),(0,i.Wv)(Fe,{key:e.kanji,"data-index":t,kanji:e.kanji,attachedMeaning:e.attachedMeaning,incorrect:e.incorrect},null,8,["data-index","kanji","attachedMeaning","incorrect"])))),128))])),_:1})]))}});const Qe=(0,M.A)(Ge,[["__scopeId","data-v-c3c4e312"]]);var $e=Qe;const Ye=e=>((0,i.Qi)("data-v-250b715e"),e=e(),(0,i.jt)(),e),qe={key:0,class:"click-save-canvas-wrapper"},Je={key:0,class:"click-save-text-wrapper"},Ze=Ye((()=>(0,i.Lk)("span",null,"Click",-1))),et=Ye((()=>(0,i.Lk)("span",null,"Start",-1))),tt=Ye((()=>(0,i.Lk)("span",null,"to",-1))),nt=Ye((()=>(0,i.Lk)("span",null,"Begin!",-1))),at=[Ze,et,tt,nt],ot={class:"settings-panel-container"},it={class:"scrollbar-rounder"},rt={class:"settings-panel"},lt=Ye((()=>(0,i.Lk)("div",{class:"panel-title"}," 設定 ",-1))),st={class:"option-container"},ct=Ye((()=>(0,i.Lk)("div",{class:"option-title"}," Answer Checking ",-1))),ut={class:"option-content"},pt={class:"group-kanji"},dt=Ye((()=>(0,i.Lk)("div",{class:"flex-grow"},"Auto-Check",-1))),vt={class:"group-kanji"},gt=Ye((()=>(0,i.Lk)("div",{class:"flex-grow"},"Auto-Continue",-1))),ht={class:"option-container"},mt=Ye((()=>(0,i.Lk)("div",{class:"option-title"}," Grouping ",-1))),ft={class:"option-content"},kt={class:"batch-size"},Lt=Ye((()=>(0,i.Lk)("div",{class:"flex-grow"},"Number of Groups",-1))),yt={class:"group-kanji"},wt=Ye((()=>(0,i.Lk)("div",{class:"flex-grow"},"Keep Groups Together",-1))),bt={class:"option-container"},Ct=Ye((()=>(0,i.Lk)("div",{class:"option-title"},"Level Limits",-1))),xt={class:"option-content"},St={class:"level-limit"},Et=["disabled"],_t={class:"level-limit"},jt=Ye((()=>(0,i.Lk)("div",{class:"flex-grow"},"Lower Limit",-1))),Rt={class:"level-limit"},Mt=Ye((()=>(0,i.Lk)("div",{class:"flex-grow"},"Use WaniKani Level",-1))),Kt={class:"option-container"},At=Ye((()=>(0,i.Lk)("div",{class:"option-title"}," WaniKani ",-1))),Tt={class:"option-content"},zt={class:"wanikani"},It=Ye((()=>(0,i.Lk)("div",null,"API Key",-1))),Xt={class:"save-button-container"},Bt={key:0},Pt={key:1};var Dt=(0,i.pM)({__name:"SettingsPanel",emits:["settingsUpdated"],setup(e,{emit:t}){const n=t,c=s(),{hasSelectedSettings:p}=(0,o.bP)(u()),d=(0,i.EW)((()=>c.useWanikaniLevel?"disabled":"")),v=(0,l.KR)(null),g=(0,l.KR)(null);function h(e){if("upper"==e)c.levelLimitUpper>60?c.levelLimitUpper=60:c.levelLimitUpper<1&&(c.levelLimitUpper=1);else if("lower"==e)c.levelLimitLower>60?c.levelLimitLower=60:c.levelLimitLower<1&&(c.levelLimitLower=1);else{if("batch"!=e)throw new Error(`Running checkLimits('${e}'), but no case for ${e}`);c.batchSize>20?c.batchSize=20:c.batchSize<1&&(c.batchSize=1)}}function m(){localStorage.setItem("settingsExist",(!0).toString()),localStorage.setItem("batchSize",c.batchSize.toString()),localStorage.setItem("groupKanji",c.groupKanji.toString()),localStorage.setItem("autoCheck",c.autoCheck.toString()),localStorage.setItem("autoContinue",c.autoContinue.toString()),localStorage.setItem("useWanikaniLevel",c.useWanikaniLevel.toString()),localStorage.setItem("wanikaniAPIKey",c.wanikaniAPIKey),localStorage.setItem("levelLimitUpper",c.levelLimitUpper.toString()),localStorage.setItem("levelLimitLower",c.levelLimitLower.toString()),n("settingsUpdated")}(0,i.sV)((()=>{if(localStorage.getItem("settingsExist")){let e=localStorage.getItem("batchSize"),t=localStorage.getItem("groupKanji"),n=localStorage.getItem("autoCheck"),a=localStorage.getItem("autoContinue"),o=localStorage.getItem("useWanikaniLevel"),i=localStorage.getItem("wanikaniAPIKey"),r=localStorage.getItem("levelLimitUpper"),l=localStorage.getItem("levelLimitLower");if(!e)throw new Error("Tried to recover batchSize from localStorage but it was undefined");if(!t)throw new Error("Tried to recover groupKanji from localStorage but it was undefined");if(!n)throw new Error("Tried to recover autoCheck from localStorage but it was undefined");if(!a)throw new Error("Tried to recover autoContinue from localStorage but it was undefined");if(!o)throw new Error("Tried to recover useWanikaniLevel from localStorage but it was undefined");if(null==i)throw new Error("Tried to recover wanikaniAPIKey from localStorage but it was null");if(!r)throw new Error("Tried to recover levelLimitUpper from localStorage but it was undefined");if(!l)throw new Error("Tried to recover levelLimitLower from localStorage but it was undefined");c.setBatchSize(Number(e)),c.setGroupKanji("true"===t),c.setAutoCheck("true"===n),c.setAutoContinue("true"===a),c.setUseWanikaniLevel("true"===o),c.setWanikaniAPIKey(i),c.setLevelLimitUpper(Number(r)),c.setLevelLimitLower(Number(l))}window.requestAnimationFrame(L)}));let f=1,k=15;function L(){if(g.value){g.value.width=window.innerWidth,g.value.height=window.innerHeight;const e=g.value.getContext("2d");if(!e||!v.value)return;const t=v.value.getBoundingClientRect();(new Date).getSeconds();let n=Math.sin(window.performance.now()*Math.PI*.001*f),a=(t.top+t.bottom)/2;const o={startx:window.innerWidth-500+n*k/-8,starty:window.innerHeight/2+n*k/-8,stopx:t.left-100+n*k,stopy:a,buttonx:t.left,buttony:a};if(o.stopy>window.innerHeight-50){const e=b({x1:o.startx,y1:o.starty,x2:o.stopx,y2:o.stopy},{x1:0,y1:window.innerHeight-50,x2:10,y2:window.innerHeight-50});o.stopx=e.x+n,o.stopy=e.y}let i=x(o.stopx-o.buttonx,o.stopy-o.buttony),r=100;const l={point1x:.25*(o.stopx-o.startx)+o.startx,point1y:(o.starty+o.stopy)/2,point2x:o.stopx+i.x*r,point2y:o.stopy+i.y*r};e.strokeStyle="#c6d0f5",e.fillStyle="#c6d0f5",e.lineWidth=10,e.lineCap="round",e.beginPath(),e.moveTo(o.startx,o.starty),e.bezierCurveTo(l.point1x,l.point1y,l.point2x,l.point2y,o.stopx,o.stopy),e.stroke();const s=C(o.stopx,o.stopy,o.buttonx,o.buttony);e.save(),e.translate(o.stopx,o.stopy),e.rotate(s),e.translate(-1*o.stopx,-1*o.stopy),e.beginPath(),e.moveTo(o.stopx,o.stopy),e.lineTo(o.stopx-20,o.stopy-20),e.stroke(),e.moveTo(o.stopx,o.stopy),e.lineTo(o.stopx-20,o.stopy+20),e.stroke(),e.fill(),e.restore(),window.requestAnimationFrame(L)}}function y(){S.Ay.from(".click-save-text-wrapper span",{duration:.5,stagger:.1,opacity:0,delay:.25,translateX:-100})}function w(e,t){S.Ay.to(".click-save-text-wrapper span",{duration:.5,stagger:.1,opacity:0,delay:.25,translateX:100,onComplete:t})}return(e,t)=>((0,i.uX)(),(0,i.CE)("section",null,[(0,i.Lk)("div",{class:(0,r.C4)(["click-save-overlay",(0,l.R1)(p)?"hide-overlay":""])},null,2),(0,i.bF)(a.eB,{name:"arrow",appear:""},{default:(0,i.k6)((()=>[(0,l.R1)(p)?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",qe,[(0,i.Lk)("canvas",{ref_key:"canvasEl",ref:g,class:"click-save-canvas"},null,512)]))])),_:1}),(0,i.bF)(a.eB,{appear:"",onEnter:y,onLeave:w},{default:(0,i.k6)((()=>[(0,l.R1)(p)?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",Je,at))])),_:1}),(0,i.Lk)("div",ot,[(0,i.Lk)("div",it,[(0,i.Lk)("div",rt,[lt,(0,i.Lk)("div",st,[ct,(0,i.Lk)("div",ut,[(0,i.Lk)("div",pt,[dt,(0,i.bo)((0,i.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=e=>(0,l.R1)(c).autoCheck=e)},null,512),[[a.lH,(0,l.R1)(c).autoCheck]])]),(0,i.Lk)("div",vt,[gt,(0,i.bo)((0,i.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=e=>(0,l.R1)(c).autoContinue=e)},null,512),[[a.lH,(0,l.R1)(c).autoContinue]])])])]),(0,i.Lk)("div",ht,[mt,(0,i.Lk)("div",ft,[(0,i.Lk)("div",kt,[Lt,(0,i.bo)((0,i.Lk)("input",{type:"number",onBlur:t[2]||(t[2]=e=>h("batch")),"onUpdate:modelValue":t[3]||(t[3]=e=>(0,l.R1)(c).batchSize=e)},null,544),[[a.Jo,(0,l.R1)(c).batchSize]])]),(0,i.Lk)("div",yt,[wt,(0,i.bo)((0,i.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=e=>(0,l.R1)(c).groupKanji=e)},null,512),[[a.lH,(0,l.R1)(c).groupKanji]])])])]),(0,i.Lk)("div",bt,[Ct,(0,i.Lk)("div",xt,[(0,i.Lk)("div",St,[(0,i.Lk)("div",{class:(0,r.C4)(["flex-grow",d.value])},"Upper Limit",2),(0,i.bo)((0,i.Lk)("input",{type:"number",onBlur:t[5]||(t[5]=e=>h("upper")),"onUpdate:modelValue":t[6]||(t[6]=e=>(0,l.R1)(c).levelLimitUpper=e),disabled:(0,l.R1)(c).useWanikaniLevel},null,40,Et),[[a.Jo,(0,l.R1)(c).levelLimitUpper]])]),(0,i.Lk)("div",_t,[jt,(0,i.bo)((0,i.Lk)("input",{type:"number",onBlur:t[7]||(t[7]=e=>h("lower")),"onUpdate:modelValue":t[8]||(t[8]=e=>(0,l.R1)(c).levelLimitLower=e)},null,544),[[a.Jo,(0,l.R1)(c).levelLimitLower]])]),(0,i.Lk)("div",Rt,[Mt,(0,i.bo)((0,i.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[9]||(t[9]=e=>(0,l.R1)(c).useWanikaniLevel=e)},null,512),[[a.lH,(0,l.R1)(c).useWanikaniLevel]])])])]),(0,i.Lk)("div",Kt,[At,(0,i.Lk)("div",Tt,[(0,i.Lk)("div",zt,[It,(0,i.bo)((0,i.Lk)("input",{type:"password","onUpdate:modelValue":t[10]||(t[10]=e=>(0,l.R1)(c).wanikaniAPIKey=e),placeholder:"API Key Goes Here"},null,512),[[a.Jo,(0,l.R1)(c).wanikaniAPIKey]])])])]),(0,i.Lk)("div",Xt,[(0,i.Lk)("button",{id:"settings-save-button",class:"save-button",ref_key:"saveButtonEl",ref:v,onClick:m},[(0,i.bF)(a.eB,{name:"save-button",mode:"out-in"},{default:(0,i.k6)((()=>[(0,l.R1)(p)?((0,i.uX)(),(0,i.CE)("span",Pt,"Update")):((0,i.uX)(),(0,i.CE)("span",Bt,"Start"))])),_:1})],512)])])])])]))}});const Wt=(0,M.A)(Dt,[["__scopeId","data-v-250b715e"]]);var Ut=Wt,Ft=(0,i.pM)({__name:"AppStage",setup(e){const t=s(),n=c(),a=u(),o=(0,l.KR)(null);a.setCheckAnswers(E);let p=(0,l.KR)(null),d=(0,l.KR)("");const v=(0,l.KR)(null),g=(0,l.KR)(""),h=(0,l.KR)(""),y=(0,l.KR)(!0),w=(0,i.EW)((()=>y.value?"showSettings":""));function b(){n.isDragging&&(n.draggingAttachedCharacter&&n.draggingMeaning&&a.processDrop({goingToCharacter:"MEANINGZONE",comingFromCharacter:n.draggingAttachedCharacter,oldMeaning:"MEANINGZONE",newMeaning:n.draggingMeaning}),n.clearDragging())}function C(e){n.setPointerPosition({x:e.x,y:e.y}),n.checkCursor()}function x(){a.readyToGoToNextKanjiBatch?A(m(),"Retrieving next kanji set...",!0):_()}function E(){a.modelData.meanings.length<=0&&t.autoCheck&&_()}function _(){let e=!0;a.modelData.characters.forEach((t=>{let n=t.correctMeaning==t.attachedMeaning;n||(e=!1),t.incorrect=!n})),e&&t.autoContinue?(document.querySelectorAll(".kanji").forEach((e=>{e.style.pointerEvents="none"})),setTimeout((()=>{S.Ay.to(".shine",{duration:.2,translateY:"50%",stagger:.05,onComplete:()=>{setTimeout((()=>{A(m(),"Retrieving next kanji set...",!0)}),250)}})}),500)):e&&(document.querySelectorAll(".kanji").forEach((e=>{e.style.pointerEvents="none"})),setTimeout((()=>{S.Ay.to(".shine",{duration:.1,translateY:"50%",stagger:.05,onComplete:()=>{j(m(),"Looking good!",!0),setTimeout((()=>{a.setReadyToGoToNextKanjiBatch(!0),setTimeout((()=>{R()}),1e3)}),1e3)}})}),250))}function j(e,t,n){if(!e||!t)throw new Error("You must enter popup text");if(!v.value||!v.value.popover)throw new Error("popover ref is null");g.value=e,h.value=t,v.value.popover.style.pointerEvents="initial",v.value.popover.classList.add("show"),n&&v.value.popover.classList.add("animate")}function R(){if(!v.value||!v.value.popover)throw new Error("popover ref is null");v.value.popover.style.pointerEvents="none",v.value.popover.classList.remove("show"),v.value.popover.classList.remove("animate")}function M(){if(!o.value)throw new Error("Tried to access puzzleStage ref but it's null");o.value.style.transition="width 1s cubic-bezier(.75,0,.25,1)",setTimeout((()=>{if(!o.value)throw new Error("Tried to access puzzleStage ref but it's null");o.value.style.transition=""}),1e3),y.value=!y.value}function K(){!p.value&&t.wanikaniAPIKey?(j("ちょい待ちこ","Fetching Wanikani info...",!1),L(t.wanikaniAPIKey).then((e=>{p.value=e.data.level,d.value=e.data.username,a.setHasSelectedSettings(!0),M(),A("設定をセーブしたよん！","Retrieving kanji list...",!1)}))):(a.setHasSelectedSettings(!0),M(),A("設定をセーブしたよん！","Retrieving kanji list...",!1))}function A(e,n,o){j(e,n,o),a.clearModelData(),setTimeout((()=>{a.setReadyToGoToNextKanjiBatch(!1);let e=t.levelLimitUpper;t.useWanikaniLevel&&p.value&&d&&(e=p.value);let n={type:"KanjiBatchRequest",data:{user_id:d.value,group_count:t.batchSize,max_level:e,min_level:t.levelLimitLower,min_group_size:2}},o=f(n);o.then((e=>{T(e),setTimeout(R,1e3)}))}),1e3)}function T(e){const n=[],o=[];if(t.groupKanji&&t.batchSize>1){let t=k(Object.entries(e)),i=new Set,r=[];t.forEach((t=>{let n=parseInt(t[0]);if(!i.has(n)){i.add(n);let a=[],o=t[1];a.push(o),o.visually_similar_subject_ids.forEach((t=>{if(!i.has(t)){if(i.add(t),!e[t])return;a.push(e[t])}})),r.push(...a)}})),r.forEach((e=>{n.push(e.meaning),o.push({kanji:e.character,correctMeaning:e.meaning,attachedMeaning:"",incorrect:null})})),a.setModelData(k(n),o,!0)}else{for(const t of Object.values(e))n.push(t.meaning),o.push({kanji:t.character,correctMeaning:t.meaning,attachedMeaning:"",incorrect:null});a.setModelData(k(n),k(o),!0)}}return(e,t)=>((0,i.uX)(),(0,i.CE)("div",{id:"stage",class:(0,r.C4)(w.value),onPointermove:C,onPointerup:b},[(0,i.bF)(O,{popoverText:g.value,popoverSubtext:h.value,ref_key:"popover",ref:v},null,8,["popoverText","popoverSubtext"]),(0,i.bF)(ae),(0,i.bF)(D,{onTogglesettings:M}),(0,i.Lk)("div",{ref_key:"puzzleStage",ref:o,id:"puzzle-stage"},[(0,i.bF)(Me,{onOnSubmit:x}),(0,i.bF)($e),(0,i.bF)(Ut,{onSettingsUpdated:K})],512)],34))}});const Nt=(0,M.A)(Ft,[["__scopeId","data-v-733bbd1e"]]);var Ot=Nt,Vt=(0,i.pM)({__name:"App",setup(e){return(e,t)=>((0,i.uX)(),(0,i.CE)("main",null,[(0,i.bF)(Ot)]))}});const Ht=Vt;var Gt=Ht;const Qt=(0,o.Ey)(),$t=(0,a.Ef)(Gt);$t.use(Qt),$t.mount("#app")}},t={};function n(a){var o=t[a];if(void 0!==o)return o.exports;var i=t[a]={exports:{}};return e[a].call(i.exports,i,i.exports,n),i.exports}n.m=e,function(){var e=[];n.O=function(t,a,o,i){if(!a){var r=1/0;for(u=0;u<e.length;u++){a=e[u][0],o=e[u][1],i=e[u][2];for(var l=!0,s=0;s<a.length;s++)(!1&i||r>=i)&&Object.keys(n.O).every((function(e){return n.O[e](a[s])}))?a.splice(s--,1):(l=!1,i<r&&(r=i));if(l){e.splice(u--,1);var c=o();void 0!==c&&(t=c)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[a,o,i]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};n.O.j=function(t){return 0===e[t]};var t=function(t,a){var o,i,r=a[0],l=a[1],s=a[2],c=0;if(r.some((function(t){return 0!==e[t]}))){for(o in l)n.o(l,o)&&(n.m[o]=l[o]);if(s)var u=s(n)}for(t&&t(a);c<r.length;c++)i=r[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(u)},a=self["webpackChunksimilar_kanji_puzzle"]=self["webpackChunksimilar_kanji_puzzle"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=n.O(void 0,[504],(function(){return n(6025)}));a=n.O(a)})();
//# sourceMappingURL=app.b6383b63.js.map